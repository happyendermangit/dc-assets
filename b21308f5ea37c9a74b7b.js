(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["94595"],{89400:function(e,t,s){var i={"./activities-rocket-time.mp3":"329160","./activity_end.mp3":"376343","./activity_launch.mp3":"865814","./activity_user_join.mp3":"44774","./activity_user_left.mp3":"964929","./call_calling.mp3":"32596","./call_ringing.mp3":"173447","./call_ringing_beat.mp3":"942044","./call_ringing_halloween.mp3":"707746","./call_ringing_snowsgiving.mp3":"753257","./clip_error.mp3":"933574","./clip_save.mp3":"393686","./ddr-down.mp3":"497452","./ddr-left.mp3":"524997","./ddr-right.mp3":"888937","./ddr-up.mp3":"341667","./deafen.mp3":"866563","./detune_call_calling.mp3":"563137","./detune_call_ringing.mp3":"905829","./detune_deafen.mp3":"575866","./detune_discodo.mp3":"488859","./detune_disconnect.mp3":"574665","./detune_message1.mp3":"881288","./detune_mute.mp3":"22295","./detune_ptt_start.mp3":"409382","./detune_ptt_stop.mp3":"805441","./detune_stream_ended.mp3":"274007","./detune_stream_started.mp3":"887823","./detune_stream_user_joined.mp3":"203788","./detune_stream_user_left.mp3":"118472","./detune_undeafen.mp3":"494640","./detune_unmute.mp3":"434247","./detune_user_join.mp3":"99572","./detune_user_leave.mp3":"894653","./detune_user_moved.mp3":"267717","./discodo.mp3":"904613","./disconnect.mp3":"17802","./hang_status_select.mp3":"980401","./highfive_clap.mp3":"362389","./highfive_whistle.mp3":"937092","./human_man.mp3":"649460","./mention1.mp3":"748590","./mention2.mp3":"345856","./mention3.mp3":"607031","./message1.mp3":"302509","./message2.mp3":"458161","./message3.mp3":"436814","./mute.mp3":"992974","./overlayunlock.mp3":"112157","./poggermode_achievement_unlock.mp3":"537390","./poggermode_applause.mp3":"829719","./poggermode_enabled.mp3":"988826","./poggermode_message_send.mp3":"305456","./ptt_start.mp3":"15872","./ptt_stop.mp3":"144821","./reconnect.mp3":"110276","./robot_man.mp3":"437477","./stage_waiting.mp3":"44122","./stream_ended.mp3":"855479","./stream_started.mp3":"829131","./stream_user_joined.mp3":"713959","./stream_user_left.mp3":"877990","./success.mp3":"87973","./undeafen.mp3":"990161","./unmute.mp3":"216636","./user_join.mp3":"170438","./user_leave.mp3":"911578","./user_moved.mp3":"455307"};function n(e){return s(a(e))}function a(e){if(!s.o(i,e)){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.id='"89400"',n.keys=function(){return Object.keys(i)},n.resolve=a,e.exports=n},437412:function(e,t,s){"use strict";e.exports=s.p+"5fca68e67f05bed32eb4.png"},93902:function(e,t,s){"use strict";e.exports=s.p+"de1981a6479d060d8ebd.png"},329160:function(e,t,s){"use strict";e.exports=s.p+"f8fb88f65f33f224c7b3.mp3"},376343:function(e,t,s){"use strict";e.exports=s.p+"ff974df9426e43392cbf.mp3"},865814:function(e,t,s){"use strict";e.exports=s.p+"259813ba8e00b2a211cb.mp3"},44774:function(e,t,s){"use strict";e.exports=s.p+"70b22eab409925d6f8f8.mp3"},964929:function(e,t,s){"use strict";e.exports=s.p+"bb8db567f29cb0cd4fef.mp3"},32596:function(e,t,s){"use strict";e.exports=s.p+"bc4e660a66b0712b5114.mp3"},173447:function(e,t,s){"use strict";e.exports=s.p+"e72bd9a68c5a5de4b084.mp3"},942044:function(e,t,s){"use strict";e.exports=s.p+"1339b5d1d553f40ac2bc.mp3"},707746:function(e,t,s){"use strict";e.exports=s.p+"e19cc32298b291be6b3d.mp3"},753257:function(e,t,s){"use strict";e.exports=s.p+"3c6cc93eaab97c478abe.mp3"},933574:function(e,t,s){"use strict";e.exports=s.p+"46ecf97d21def02d585f.mp3"},393686:function(e,t,s){"use strict";e.exports=s.p+"607f4f5830fc13d0b251.mp3"},497452:function(e,t,s){"use strict";e.exports=s.p+"c02408469ee033a4ee3a.mp3"},524997:function(e,t,s){"use strict";e.exports=s.p+"fbf60e1284cc54dc0e5e.mp3"},888937:function(e,t,s){"use strict";e.exports=s.p+"ea5f09e9af94f92edc3a.mp3"},341667:function(e,t,s){"use strict";e.exports=s.p+"615ef618987056fd1bd2.mp3"},866563:function(e,t,s){"use strict";e.exports=s.p+"6cb3ea10151e5b2ffb07.mp3"},563137:function(e,t,s){"use strict";e.exports=s.p+"fef4303b284e8445f8e9.mp3"},905829:function(e,t,s){"use strict";e.exports=s.p+"0218b16de15cb2f7724c.mp3"},575866:function(e,t,s){"use strict";e.exports=s.p+"3ab587f5e0363cb3b453.mp3"},488859:function(e,t,s){"use strict";e.exports=s.p+"a6e48e91e0069b28d2ca.mp3"},574665:function(e,t,s){"use strict";e.exports=s.p+"c2e8cc718f4394e2fd6d.mp3"},881288:function(e,t,s){"use strict";e.exports=s.p+"582c42ea90dc65482716.mp3"},22295:function(e,t,s){"use strict";e.exports=s.p+"77b7d43241726f405cc1.mp3"},409382:function(e,t,s){"use strict";e.exports=s.p+"08385764d2c5b826af6b.mp3"},805441:function(e,t,s){"use strict";e.exports=s.p+"2da7a98f354d6208d66f.mp3"},274007:function(e,t,s){"use strict";e.exports=s.p+"70a0184ec509ec277062.mp3"},887823:function(e,t,s){"use strict";e.exports=s.p+"cb8e5ebd782353d41f83.mp3"},203788:function(e,t,s){"use strict";e.exports=s.p+"6d2fdab68b3e6d97914f.mp3"},118472:function(e,t,s){"use strict";e.exports=s.p+"674ddc50a69a27d0c36c.mp3"},494640:function(e,t,s){"use strict";e.exports=s.p+"62f48861f90d5e622587.mp3"},434247:function(e,t,s){"use strict";e.exports=s.p+"de752bcdde8d8c52ab11.mp3"},99572:function(e,t,s){"use strict";e.exports=s.p+"0fc2742bb405e81bc1c4.mp3"},894653:function(e,t,s){"use strict";e.exports=s.p+"9bb7b5e7d71c1fcbb69b.mp3"},267717:function(e,t,s){"use strict";e.exports=s.p+"2305850be26e674a9bc0.mp3"},904613:function(e,t,s){"use strict";e.exports=s.p+"44208515805198d4c548.mp3"},17802:function(e,t,s){"use strict";e.exports=s.p+"e08aa3fc806a6137b9af.mp3"},980401:function(e,t,s){"use strict";e.exports=s.p+"d20b9636e9ef7c82b9ec.mp3"},362389:function(e,t,s){"use strict";e.exports=s.p+"6cc13ddadaadc1e9acfb.mp3"},937092:function(e,t,s){"use strict";e.exports=s.p+"06b0ec919358fd00a1c9.mp3"},649460:function(e,t,s){"use strict";e.exports=s.p+"1003a3a0720d56ebe8d8.mp3"},748590:function(e,t,s){"use strict";e.exports=s.p+"6fded0954ad6fa7fc2ec.mp3"},345856:function(e,t,s){"use strict";e.exports=s.p+"57cd70365a486a399e4a.mp3"},607031:function(e,t,s){"use strict";e.exports=s.p+"951cb91ee4aedb54e555.mp3"},302509:function(e,t,s){"use strict";e.exports=s.p+"7e95e417e6decf91459a.mp3"},458161:function(e,t,s){"use strict";e.exports=s.p+"d98b3cb5756a0c4908ab.mp3"},436814:function(e,t,s){"use strict";e.exports=s.p+"b8fbd5bcaed3d51b8b73.mp3"},992974:function(e,t,s){"use strict";e.exports=s.p+"574a4b46a370c821f4c2.mp3"},112157:function(e,t,s){"use strict";e.exports=s.p+"9be773476c4dfc20a049.mp3"},537390:function(e,t,s){"use strict";e.exports=s.p+"99e4a1dff8fdc40994d0.mp3"},829719:function(e,t,s){"use strict";e.exports=s.p+"98cc8cdf9f7711301b27.mp3"},988826:function(e,t,s){"use strict";e.exports=s.p+"9b0de13058a4eff892f3.mp3"},305456:function(e,t,s){"use strict";e.exports=s.p+"789fbb057da285769ee4.mp3"},15872:function(e,t,s){"use strict";e.exports=s.p+"e02be8f7ceaa6b3a2e72.mp3"},144821:function(e,t,s){"use strict";e.exports=s.p+"8d26e762622d49b2a607.mp3"},110276:function(e,t,s){"use strict";e.exports=s.p+"09d327b608c3bd75cd85.mp3"},437477:function(e,t,s){"use strict";e.exports=s.p+"c9a9c1767b82a09a02d1.mp3"},44122:function(e,t,s){"use strict";e.exports=s.p+"b33d3bd272e8ad1308f1.mp3"},855479:function(e,t,s){"use strict";e.exports=s.p+"1877b1bd5a52d560309a.mp3"},829131:function(e,t,s){"use strict";e.exports=s.p+"57251e1318cb6545df91.mp3"},713959:function(e,t,s){"use strict";e.exports=s.p+"1387160f6f2937093609.mp3"},877990:function(e,t,s){"use strict";e.exports=s.p+"215c23b18a529793b0c3.mp3"},87973:function(e,t,s){"use strict";e.exports=s.p+"220087059cee59de6537.mp3"},990161:function(e,t,s){"use strict";e.exports=s.p+"a338e62624013a20f7df.mp3"},216636:function(e,t,s){"use strict";e.exports=s.p+"94ac01bdba0749ee103c.mp3"},170438:function(e,t,s){"use strict";e.exports=s.p+"e4c08b716d0db705facc.mp3"},911578:function(e,t,s){"use strict";e.exports=s.p+"14601f9cdbd78f8fe7ef.mp3"},455307:function(e,t,s){"use strict";e.exports=s.p+"aaa90875db91174f3e8a.mp3"},235898:function(e,t,s){"use strict";s.r(t),s.d(t,{useMaybeFetchCollectiblesCategories:function(){return l},default:function(){return c}}),s("222007");var i=s("884691"),n=s("65597"),a=s("875212"),r=s("21526"),u=s("853987"),o=s("775416");function l(){let e="useMaybeFetchCollectiblesCategories";(0,a.useTriggerDebuggingAA)({location:e+" auto on",autoTrackExposure:!0}),(0,a.useTriggerDebuggingAA)({location:e+" auto off",autoTrackExposure:!1});let[t,s,o,l]=(0,n.useStateFromStoresArray)([u.default],()=>{var e;return[u.default.isFetching,u.default.error,null!==(e=u.default.lastFetched)&&void 0!==e?e:0,u.default.categories]});return(0,i.useEffect)(()=>{!(t||s||Date.now()-o<6e5)&&(0,r.fetchCollectiblesCategories)()},[t,o,s]),{isFetching:t,categories:l,error:s}}function c(){var e;let t="useFetchCollectiblesCategoriesAndPurchases";(0,a.useTriggerDebuggingAA)({location:t+" auto on",autoTrackExposure:!0}),(0,a.useTriggerDebuggingAA)({location:t+" auto off",autoTrackExposure:!1});let{isFetching:s,categories:u,error:c}=l(),{isClaiming:d,fetchError:p,claimError:f,isFetching:m,purchases:h}=function(){let e="useFetchPurchases";(0,a.useTriggerDebuggingAA)({location:e+" auto on",autoTrackExposure:!0}),(0,a.useTriggerDebuggingAA)({location:e+" auto off",autoTrackExposure:!1});let[t,s,u,l,c]=(0,n.useStateFromStoresArray)([o.default],()=>[o.default.isFetching,o.default.isClaiming,o.default.fetchError,o.default.claimError,o.default.purchases]);return(0,i.useEffect)(()=>{(0,r.fetchCollectiblesPurchases)()},[]),{isClaiming:s,fetchError:u,claimError:l,isFetching:t,purchases:c}}(),g=null!==(e=null!=c?c:p)&&void 0!==e?e:f;return{isFetching:s||m,isFetchingCategories:s,isFetchingPurchases:m,isClaiming:d,categories:u,purchases:h,error:g}}},426188:function(e,t,s){"use strict";s.r(t),s.d(t,{useFetchCollectiblesProduct:function(){return l}}),s("222007");var i=s("884691"),n=s("65597"),a=s("552712"),r=s("21526"),u=s("853987"),o=s("49111");function l(e){let t=(0,n.default)([a.default],()=>null!=e?a.default.get(e):null),s=null!=t&&t.productLine!==o.SKUProductLines.COLLECTIBLES,[l,c]=(0,n.useStateFromStoresArray)([u.default],()=>[u.default.isFetching,u.default.getProduct(e)]);return(0,i.useEffect)(()=>{null!=e&&null==c&&!s&&!l&&(0,r.fetchCollectiblesProduct)(e)},[e,c,s,l]),{product:c,isFetching:l}}},355033:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return _}});var i=s("37983");s("884691");var n=s("265586"),a=s("446674"),r=s("77078"),u=s("606292"),o=s("688318"),l=s("601095"),c=s("697218"),d=s("853987"),p=s("929392");let f=r.AvatarSizes.SIZE_152,m=(0,u.getDecorationSizeForAvatarSize)(f),h=e=>{let{item:t}=e,s=(0,a.useStateFromStores)([c.default],()=>c.default.getCurrentUser()),{avatarDecorationSrc:n,avatarPlaceholderSrc:u,eventHandlers:l}=(0,o.default)({user:s,avatarDecorationOverride:t,size:m});return(0,i.jsx)("div",{className:p.avatarDecorationPreview,children:(0,i.jsx)(r.Avatar,{...l,"aria-label":t.label,src:u,avatarDecoration:n,size:f})})},g=e=>{let{item:t}=e;return(0,i.jsx)("div",{className:p.profileEffectPreview,children:(0,i.jsx)(l.default,{isHovering:!0,profileEffectId:null==t?void 0:t.id})})};var _=e=>{let{giftCode:t}=e,s=(0,a.useStateFromStores)([d.default],()=>d.default.getProduct(t.skuId)),r=null==s?void 0:s.items[0];return(0,i.jsxs)(i.Fragment,{children:[(null==r?void 0:r.type)===n.CollectiblesItemType.AVATAR_DECORATION&&(0,i.jsx)(h,{item:r}),(null==r?void 0:r.type)===n.CollectiblesItemType.PROFILE_EFFECT&&(0,i.jsx)(g,{item:r})]})}},264579:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return a}});var i=s("37983");s("884691");var n=s("77078"),a=e=>{let{product:t,category:a,analyticsLocations:r}=e;(0,n.openModalLazy)(async()=>{let{default:e}=await s.el("658756").then(s.bind(s,"658756"));return s=>(0,i.jsx)(e,{analyticsLocations:r,...s,product:t,category:a})})}},669146:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Q}}),s("222007"),s("70102");var i=s("37983"),n=s("884691"),a=s("414456"),r=s.n(a),u=s("265586"),o=s("446674"),l=s("819855"),c=s("77078"),d=s("569272"),p=s("841098"),f=s("206230"),m=s("812204"),h=s("685665"),g=s("651057"),_=s("299285"),x=s("853987"),b=s("491232"),C=s("235898"),S=s("426188"),v=s("355033"),I=s("264579"),T=s("526887"),E=s("393414"),A=s("55411"),y=s("686470"),O=s("697218"),M=s("10514"),F=s("552712"),N=s("953109"),R=s("476765"),j=s("599110"),G=s("402671"),P=s("659632"),D=s("380186"),L=s("158998"),k=s("895737"),w=s("210721"),U=s("845149"),H=s("65324"),B=s("646718"),z=s("49111"),V=s("782340"),Y=s("139194"),Z=s("653240"),W=s("140802");let X=e=>{let{openedGift:t}=e,{createMultipleConfettiAt:s}=n.useContext(T.ConfettiCannonContext);return n.useEffect(()=>{t&&s(window.innerWidth/2,window.innerHeight/4)},[s,t]),null},K=e=>{let{step:t,soundId:s}=e;return n.useEffect(()=>{t===z.GiftCodeModalStates.CONFIRM&&(0,k.playGiftSound)(s,1)},[t,s]),null};class q extends n.Component{componentDidMount(){let{application:e,sku:t,customGiftMessage:s,giftCode:i,emojiName:n}=this.props;null==e&&null!=t&&g.default.fetchApplication(t.applicationId);let a=null!=s||null!=i.giftStyle,r=(0,b.isCollectiblesGiftCode)(i),u=null!=n?G.default.getURL(n):void 0;this.setState({isCustomGift:a,isCollectiblesGift:r,emojiURL:u,opened:r}),this.trackStepAnalytics()}get step(){let{libraryApplication:e,accepting:t,giftCode:s}=this.props,{error:i,accepted:n,opened:a,isCustomGift:r}=this.state;return(0,P.getStep)(e,s,i,n,t,a,r)}get buttonText(){return(0,P.getButtonText)(this.step,this.props.giftCode,this.state.isCustomGift)}get firstHeaderText(){let{isCustomGift:e,opened:t,accepted:s}=this.state,{giftCode:i,subscriptionPlan:n,collectiblesItemType:a}=this.props;if(e&&this.step===z.GiftCodeModalStates.ERROR)return V.default.Messages.GIFT_CONFIRMATION_HEADER_FAIL;if(e&&!s){if(!t)return V.default.Messages.GIFT_RECIPIENT_INFO.format({recipientDisplayName:L.default.getName(O.default.getCurrentUser())});{let e=O.default.getUser(i.userId),t=L.default.getName(e);return a===u.CollectiblesItemType.AVATAR_DECORATION?V.default.Messages.COLLECTIBLES_SENDER_GIFTED_YOU_DECORATION.format({sender:t}):a===u.CollectiblesItemType.PROFILE_EFFECT?V.default.Messages.COLLECTIBLES_SENDER_GIFTED_YOU_EFFECT.format({sender:t}):V.default.Messages.GIFT_SUBSCRIPTION_INFO.format({sender:t,timeInterval:(null==n?void 0:n.interval)===B.SubscriptionIntervalTypes.MONTH?V.default.Messages.PREMIUM_SUBSCRIPTION_INTERVAL_MONTH:V.default.Messages.PREMIUM_SUBSCRIPTION_INTERVAL_YEAR})}}return null==this.props.sku?null:(0,P.getHeaderText)(this.step,this.props.giftCode,this.props.sku)}get secondHeaderText(){if(!this.state.isCustomGift||this.state.opened||this.state.accepted)return null;let e=O.default.getUser(this.props.giftCode.userId);return V.default.Messages.GIFT_SENDER_INFO.format({sender:L.default.getName(e)})}get bodyText(){let{sku:e,accepting:t,libraryApplication:s,subscriptionPlan:i}=this.props;if(null==e)return null;let{error:n,accepted:a,isCustomGift:r,opened:u}=this.state;return!u&&r?null:(0,P.getBodyText)({step:this.step,sku:e,libraryApplication:s,error:n,accepted:a,accepting:t,onGoToLibrary:this.handleGoToLibrary,subscriptionPlan:i})}get errorMessage(){let{libraryApplication:e,accepting:t}=this.props,{error:s,accepted:i}=this.state;return(0,P.getErrorMessage)(e,s,i,t,this.handleGoToLibrary)}get handleClick(){let{giftCode:e,onClose:t}=this.props;switch(this.step){case z.GiftCodeModalStates.ERROR:return t;case z.GiftCodeModalStates.SUCCESS:if(__OVERLAY__||null!=e.subscriptionPlanId)return t;return this.handleGoToLibrary;case z.GiftCodeModalStates.OPEN:return this.handleOpen;case z.GiftCodeModalStates.CONFIRM:default:return this.handleAccept}}trackStepAnalytics(){let{giftCode:e,customGiftMessage:t,emojiName:s,soundId:i}=this.props,{isCustomGift:n}=this.state;j.default.track(z.AnalyticEvents.GIFT_ACCEPT_STEP,{to_step:this.step,has_custom_message:n,is_custom_message_edited:n&&t!==V.default.Messages.DEFAULT_CUSTOM_GIFT_MESSAGE,gift_style:e.giftStyle,gift_code:e.code,emoji_name:s,sound_id:i})}render(){let{application:e,accepting:t,onClose:s,giftCode:n,headerId:a,transitionState:u,useReducedMotion:o,onComplete:l,customGiftMessage:d,emojiName:p,soundId:f,isThemeDark:m}=this.props,h=O.default.getUser(n.userId),{isCustomGift:g,isCollectiblesGift:_,accepted:x,opened:b,emojiURL:C}=this.state,S=O.default.getCurrentUser(),I=this.step===z.GiftCodeModalStates.ERROR,T=(null==n?void 0:n.userId)!=null&&null!=S&&(null==S?void 0:S.id)!=null&&n.userId===S.id;switch(this.step){case z.GiftCodeModalStates.ERROR:null==l||l(n,!1);break;case z.GiftCodeModalStates.SUCCESS:null==l||l(n,!0)}return(0,i.jsxs)("div",{ref:this.modalRef,children:[(0,i.jsxs)(c.ModalRoot,{transitionState:u,size:c.ModalSize.SMALL,className:Y.modal,"aria-labelledby":a,children:[null!=n.giftStyle&&!g&&!_&&(0,i.jsx)(H.default,{defaultAnimationState:this.getDefaultAnimationStatus(),idleAnimationState:this.getIdleAnimationStatus(),giftStyle:n.giftStyle,className:Y.seasonalGiftIcon}),(0,i.jsx)("div",{className:g?void 0:Y.backSplash}),(0,i.jsxs)(c.ModalContent,{className:r({[Y.content]:!g,[Y.contentCustomGift]:g}),children:[!_&&(0,i.jsx)(c.ModalCloseButton,{onClick:s,className:Y.closeButton}),!_&&(null==n.giftStyle||g&&x)&&(0,i.jsx)(N.default,{size:N.default.Sizes.LARGE,game:e,skuId:n.skuId}),I&&(0,i.jsx)("img",{alt:"",src:m?Z:W}),(0,i.jsxs)(c.Heading,{id:a,className:r({[Y.customGiftHeader]:g&&!x,[Y.header]:!g||x}),variant:"heading-sm/semibold",children:[(0,i.jsx)("div",{className:r({[Y.customGiftHeaderText]:g}),children:this.firstHeaderText}),(0,i.jsx)("div",{children:this.secondHeaderText})]}),!(g&&!x)&&(0,i.jsx)(c.Text,{className:Y.body,variant:"text-sm/normal",children:this.bodyText}),g&&!_&&null!=n.giftStyle&&!x&&(0,i.jsx)(H.default,{defaultAnimationState:this.getDefaultAnimationStatus(),idleAnimationState:this.getIdleAnimationStatus(),className:Y.giftAnimation,giftStyle:n.giftStyle}),this.state.opened&&!I&&(0,i.jsx)(v.default,{giftCode:n}),I&&(0,i.jsx)(c.Text,{className:Y.body,variant:"text-md/normal",children:this.errorMessage}),g&&this.state.opened&&!this.state.accepted&&!I&&null!=d&&""!==d&&!T&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.FormTitle,{children:V.default.Messages.GIFT_SENDER_INFO.format({sender:L.default.getName(h)})}),(0,i.jsx)(c.Heading,{id:a,className:Y.customMessage,variant:"heading-sm/bold",children:d})]}),(0,i.jsx)(c.Button,{submitting:t,onClick:()=>{this.trackStepAnalytics(),this.handleClick()},children:this.buttonText})]})]}),null!=n.giftStyle&&!o&&this.step!==z.GiftCodeModalStates.ERROR&&(0,i.jsx)(i.Fragment,{children:!x&&!t&&b&&(null==p||null==C?(0,i.jsx)(X,{openedGift:b&&!x&&!t}):(0,i.jsx)(U.default,{confettiTarget:this.modalRef.current,emojiURL:C}))}),!x&&!t&&b&&null!=f&&(0,i.jsx)(K,{soundId:f,step:this.step})]})}constructor(...e){super(...e),this.state={error:null,accepted:!1,opened:!1,isCustomGift:!1,isCollectiblesGift:!1,step:void 0,emojiURL:void 0},this.modalRef=n.createRef(),this.handleOpen=()=>{this.setState({opened:!0})},this.handleAccept=async()=>{let{giftCode:e,channelContext:t,onAccept:s}=this.props;if(null==e)throw Error("GiftCode is null at acceptance.");try{await d.default.redeemGiftCode(e.code,{channelId:t}),this.setState({accepted:!0}),null==s||s()}catch(e){this.setState({error:e})}},this.handleGoToLibrary=()=>{let{onClose:e,libraryApplication:t}=this.props;(0,E.transitionTo)(z.Routes.APPLICATION_LIBRARY,{state:{applicationId:null!=t?t.id:null}}),e()},this.getDefaultAnimationStatus=()=>{if(this.step===z.GiftCodeModalStates.OPEN)return w.AnimationState.IDLE;return w.AnimationState.ACTION},this.getIdleAnimationStatus=()=>{if(this.step!==z.GiftCodeModalStates.OPEN)return w.AnimationState.LOOP}}}let J=o.default.connectStores([y.default,F.default,_.default,A.default,M.default,f.default],e=>{let{giftCode:t}=e,s=F.default.get(t.skuId),i=null!=s?_.default.getApplication(s.applicationId):null,n=f.default.useReducedMotion;return{sku:s,libraryApplication:null!=s&&(null==t?void 0:t.entitlementBranches)!=null?(0,P.firstLibraryApplicationForGiftCode)(t.entitlementBranches,s,y.default):null,application:i,subscriptionPlan:null!=t.subscriptionPlanId?(0,D.getOrFetchSubscriptionPlan)(t.subscriptionPlanId):null,accepting:A.default.getIsAccepting(t.code),useReducedMotion:n}})(q);var Q=e=>{var t;let{channelContext:s,code:n,customGiftMessage:a,emojiName:r,soundId:u,onClose:c,...d}=e,f=(0,R.useUID)(),g=(0,o.useStateFromStores)([A.default],()=>A.default.get(n)),_=(0,p.default)(),{analyticsLocations:b}=(0,h.default)(m.default.GIFT_CODE_MODAL);(0,C.useMaybeFetchCollectiblesCategories)();let{product:v}=(0,S.useFetchCollectiblesProduct)(null==g?void 0:g.skuId),T=(0,o.useStateFromStores)([x.default],()=>x.default.getCategoryForProduct(null==g?void 0:g.skuId));return null==g?null:(0,i.jsx)(J,{...d,customGiftMessage:a,channelContext:s,giftCode:g,headerId:f,emojiName:r,soundId:u,analyticsLocations:b,isThemeDark:(0,l.isThemeDark)(_),onClose:c,collectiblesItemType:null==v?void 0:null===(t=v.items[0])||void 0===t?void 0:t.type,onAccept:null!=v?()=>{c(),(0,I.default)({product:v,category:T,analyticsLocations:b})}:void 0})}},845149:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}}),s("222007");var i=s("37983"),n=s("884691"),a=s("516555"),r=s("526887"),u=s("172858"),o=function(e){let{confettiTarget:t,colors:s,emojiURL:o}=e,[l,c]=n.useState(null),{confettiCanvas:d}=n.useContext(r.ConfettiCannonContext),p=(0,a.useConfettiCannon)(d,l),f=n.useMemo(()=>[{src:o,colorize:!1}],[o]);return n.useEffect(()=>{let e=[,,,,].fill(0);return null!=t&&(e=e.map((e,s)=>setTimeout(()=>{var e;p.createMultipleConfetti((e=t.getBoundingClientRect(),{...u.COMMON_CONFETTI_BASE_CONFIG,position:{type:"static-random",minValue:{x:e.left+100,y:e.top+75},maxValue:{x:e.left+350,y:e.top+150}},velocity:{type:"static-random",minValue:{x:-40,y:-40},maxValue:{x:40,y:-70}},size:{type:"static-random",minValue:u.COMMON_CONFETTI_MAX_SPRITE_SIZE,maxValue:u.COMMON_CONFETTI_MAX_SPRITE_SIZE},dragCoefficient:{type:"static",value:.001}}),50)},60*s))),()=>{for(let t of e)clearTimeout(t)}},[p,t]),(0,i.jsx)(a.SpriteCanvas,{ref:c,sprites:null!=f?f:u.COMMON_CONFETTI_SPRITES,colors:null!=s?s:u.COMMON_CONFETTI_COLORS,spriteWidth:u.COMMON_CONFETTI_MAX_SPRITE_SIZE,spriteHeight:u.COMMON_CONFETTI_MAX_SPRITE_SIZE})}},601095:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}}),s("222007");var i=s("37983"),n=s("884691"),a=s("414456"),r=s.n(a),u=s("859498"),o=s("635471"),l=s("825054"),c=s("93902"),d=e=>{let{profileEffectId:t,isHovering:s,forCollectedModal:a=!1,isPurchased:d,removeSetHeight:p=!1}=e,f=a?250:.1,[m,h]=n.useState(!0);return(n.useEffect(()=>{if(!0!==a)h(!1);else{let e=setTimeout(()=>{h(!1)},f);return()=>{clearTimeout(e)}}},[f,a]),null!=t)?(0,i.jsxs)("div",{className:r(l.previewContainer,{[l.previewContainerAnimation]:a,[l.previewContainerSetHeight]:!p}),children:[(0,i.jsx)("img",{src:c,alt:" ",className:a?l.previewForCollected:l.preview,"aria-hidden":!0}),!m&&(0,i.jsx)("div",{className:d?l.purchasedEffect:void 0,children:(0,i.jsx)(o.default,{profileEffectId:t,useThumbnail:!0,autoPlay:a,restartMethod:u.RestartMethod.FromStart,resetOnHover:!0,isHovering:s,introDelay:f,useOpacityOnHover:!1})})]}):null}},895737:function(e,t,s){"use strict";s.r(t),s.d(t,{playGiftSound:function(){return d},WebAudioSound:function(){return f}}),s("70102");var i=s("917351"),n=s.n(i),a=s("520497"),r=s("812809"),u=s("42887"),o=s("773336");let l="default",c=l;function d(e,t){let s=new Audio((0,a.default)(e));s.volume=(0,r.default)(t),s.play()}function p(){null!=window.navigator.mediaDevices&&window.navigator.mediaDevices.enumerateDevices().then(e=>{let t=u.default.getOutputDevices(),s=n(t).sortBy(e=>e.index).findIndex(e=>e.id===u.default.getOutputDeviceId()),i=t[u.default.getOutputDeviceId()],a=e.filter(e=>"audiooutput"===e.kind&&"communications"!==e.deviceId),r=a[s];null!=i&&(null==r||r.label!==i.name)&&(r=a.find(e=>e.label===i.name)),c=null!=r?r.deviceId:l}).catch(()=>{c=l})}o.isPlatformEmbedded&&(u.default.addChangeListener(p),p());class f{get volume(){return this._volume}set volume(e){this._volume=e,this._ensureAudio().then(t=>t.volume=e)}loop(){this._ensureAudio().then(e=>{e.loop=!0,e.play()})}play(){this._ensureAudio().then(e=>{e.loop=!1,e.play()})}pause(){null!=this._audio&&this._audio.then(e=>e.pause())}stop(){this._destroyAudio()}playWithListener(){return new Promise((e,t)=>{this._ensureAudio().then(s=>{(null==s.duration||0===s.duration)&&t("sound has no duration"),s.play(),setTimeout(()=>{e(!0)},s.duration)})})}_destroyAudio(){null!=this._audio&&(this._audio.then(e=>{e.pause(),e.src=""}),this._audio=null)}_ensureAudio(){var e;return this._audio=null!==(e=this._audio)&&void 0!==e?e:new Promise((e,t)=>{let i=new Audio;i.src=s("89400")("../../sounds/".concat(this.name,".mp3").replace("../../sounds/","./")),i.onloadeddata=()=>{i.volume=Math.min(u.default.getOutputVolume()/100*this._volume,1),o.isPlatformEmbedded&&i.setSinkId(c),e(i)},i.onerror=()=>t(Error("could not play audio")),i.onended=()=>this._destroyAudio(),i.load()}),this._audio}constructor(e,t,s){this.name=e,this._volume=s}}}}]);
//# sourceMappingURL=b21308f5ea37c9a74b7b.js.map